# Plastic Inventory

Полное руководство по установке, настройке и запуску проекта (frontend + backend). Поддерживается локальный запуск и запуск через Docker. Также приведены рекомендации по деплою на сервер (хостинг).

---

## Содержание
- [Технологии](#технологии)
- [Структура проекта](#структура-проекта)
- [Установка и запуск](#установка-и-запуск)
- [Контейнеризация (Docker)](#контейнеризация-docker)
- [Настройка переменных окружения](#настройка-переменных-окружения)
- [Деплой на сервер](#деплой-на-сервер)
- [Дополнительная информация](#дополнительная-информация)

---

## Технологии

| Категория            | Технология            | Описание                                                                 |
|----------------------|-----------------------|-------------------------------------------------------------------------|
| **Backend**          | Python               | Основной язык программирования для серверной части.                    |
|                      | FastAPI              | Фреймворк для создания REST API.                                       |
|                      | SQLite               | Легковесная реляционная база данных (`plastic.db`).                    |
|                      | Docker               | Контейнеризация серверной части.                                       |
|                      | SQLAlchemy           | ORM для работы с базой данных.                                         |
|                      | Pydantic             | Валидация данных и работа с моделями.                                  |
|                      | bcrypt               | Хэширование паролей.                                                   |
|                      | JWT                  | Аутентификация и авторизация пользователей.                            |
|                      | QR-коды              | Генерация и обработка QR-кодов.                                        |
| **Frontend**         | React                | Фреймворк для создания пользовательского интерфейса.                   |
|                      | Vite                 | Инструмент для сборки и разработки фронтенда.                          |
|                      | Axios                | HTTP-клиент для выполнения запросов к API.                             |
|                      | CSS                  | Стилизация компонентов.                                                |
|                      | JavaScript (ES6+)    | Основной язык программирования для фронтенда.                          |
|                      | ESLint               | Инструмент для проверки качества кода.                                 |
|                      | Vercel               | Конфигурация для деплоя фронтенда.                                     |
| **DevOps**           | Docker               | Контейнеризация фронтенда и бэкенда.                                   |
|                      | Nginx                | Веб-сервер для раздачи фронтенда.                                      |
|                      | Docker Compose       | Управление многоконтейнерной инфраструктурой.                          |
| **Прочее**           | Git                  | Система контроля версий.                                               |
|                      | Python Requirements  | Список зависимостей для Python (`requirements.txt`).                   |
|                      | Static Files         | Хранение статических файлов, таких как QR-коды (`static/qr_codes/`).   |

---

## Структура проекта
```
plastic-inventory/
├── backend/         # Серверная часть (FastAPI, REST API, база данных, миграции)
│   ├── routers/     # Маршруты API (авторизация, проекты, группы, типы пластика и др.)
│   ├── static/      # Статические файлы (QR-коды)
│   ├── utils/       # Вспомогательные скрипты (генерация QR и др.)
│   └── ...
├── frontend/        # Клиентская часть (React + Vite)
│   ├── src/         # Исходный код приложения
│   └── ...
├── plastic.db       # Файл базы данных SQLite (создается автоматически)
├── docker-compose.yml # Docker Compose для запуска всего стека
├── Dockerfile         # Dockerfile для сборки образа
└── README.md
```

---

## Установка и запуск

### Backend
1. Перейдите в папку backend:
   ```sh
   cd backend
   ```
2. Создайте и активируйте виртуальное окружение (Windows):
   ```sh
   python -m venv venv
   .\venv\Scripts\activate
   ```
3. Установите зависимости:
   ```sh
   pip install -r requirements.txt
   ```
4. Запустите сервер:
   ```sh
   uvicorn main:app --reload
   ```
   Сервер будет доступен по адресу http://127.0.0.1:8000

### Frontend
1. Перейдите в папку frontend:
   ```sh
   cd frontend
   ```
2. Установите зависимости:
   ```sh
   npm install
   ```
3. Запустите проект в режиме разработки:
   ```sh
   npm run dev
   ```
   Откройте браузер и перейдите по адресу, который появится в терминале (обычно http://localhost:5173)

---

## Контейнеризация (Docker)

1. Убедитесь, что Docker и docker-compose установлены.
2. В корне проекта выполните:
   ```sh
   docker-compose up --build
   ```
   - Backend будет доступен на http://localhost:8000
   - Frontend — на http://localhost:5173
3. Для остановки контейнеров:
   ```sh
   docker-compose down
   ```

---

## Настройка переменных окружения

- Все переменные для backend указываются в файле `.env`. Если файл отсутствует, используются значения по умолчанию.
- Для frontend настройте адрес API в файле `frontend/src/api/axios.js` или используйте переменные окружения Vite (`VITE_API_URL`).

---

## Деплой на сервер

### Backend
1. Загрузите содержимое папки `backend` на сервер.
2. Установите Python 3.10+ и зависимости (`pip install -r requirements.txt`).
3. Создайте файл `.env` с продакшн-значениями.
4. Запустите сервер через uvicorn/gunicorn или настройте systemd-сервис.

### Frontend
1. Загрузите содержимое папки `frontend` на сервер.
2. Измените базовый URL API в `axios.js` или настройте `VITE_API_URL`.
3. Соберите проект:
   ```sh
   npm run build
   ```
4. Настройте отдачу статики через nginx или другой веб-сервер.

---

## Дополнительная информация

### Особенности проекта
- **Модульная структура**: Проект разделен на модули для упрощения разработки и поддержки.
- **Генерация QR-кодов**: Используется библиотека `qrcode` для создания QR-кодов, которые хранятся в папке `static/qr_codes`.
- **Безопасность**: Реализована аутентификация с использованием JWT и хэширование паролей через `bcrypt`.
- **Контейнеризация**: Полная поддержка Docker для быстрого развертывания.

### Полезные команды
#### Backend
- Активация виртуального окружения (Windows):
  ```sh
  .\venv\Scripts\activate
  ```
- Установка новой зависимости:
  ```sh
  pip install <package>
  pip freeze > requirements.txt
  ```
- Запуск сервера:
  ```sh
  uvicorn main:app --reload
  ```

#### Frontend
- Установка новой зависимости:
  ```sh
  npm install <package>
  ```
- Сборка проекта:
  ```sh
  npm run build
  ```
- Запуск в режиме разработки:
  ```sh
  npm run dev
  ```

#### Docker
- Сборка и запуск контейнеров:
  ```sh
  docker-compose up --build
  ```
- Остановка контейнеров:
  ```sh
  docker-compose down
  ```

### Часто задаваемые вопросы (FAQ)
1. **Что делать, если сервер не запускается?**
   - Проверьте, что установлены все зависимости (`pip install -r requirements.txt`).
   - Убедитесь, что файл `.env` настроен корректно.

2. **Как изменить базовый URL для API?**
   - В файле `frontend/src/api/axios.js` измените значение переменной `API_URL`.

3. **Как добавить новую таблицу в базу данных?**
   - Добавьте модель в `models.py` и выполните миграции (если используются).

4. **Как изменить порт для backend?**
   - Укажите порт при запуске сервера:
     ```sh
     uvicorn main:app --host 0.0.0.0 --port 8080
     ```

